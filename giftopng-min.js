const fileNameTooltip=document.getElementById('fileNameTooltip');document.getElementById("gifInput").addEventListener('change',handleVideoUpload);function handleVideoUpload(event){const file=event.target.files[0];if(file){document.getElementById("uploadLabel").style="display: true; color: #28a745";fileNameTooltip.textContent=`"${file.name}" successfully loaded`}}
document.getElementById('gifConvertButton').addEventListener('click',function(){const fileInput=document.getElementById('gifInput');const file=fileInput.files[0];const termsCheckbox=document.getElementById('termsCheckbox');if(!file){alert('Please choose a file to convert.');return}else if(termsCheckbox.checked==!1){alert('Please read and agree to the terms and conditions.');return}
const reader=new FileReader();reader.onload=function(event){const fileContent=event.target.result;console.log('File uploaded:',file.name);console.log('File content:',fileContent);startConversion(fileContent)};reader.onerror=function(event){alert('Error reading file: '+event.target.error.code)};reader.readAsArrayBuffer(file)});function startConversion(fileContent){const file=document.getElementById('gifInput').files[0];document.getElementById("load").style="display: true";if(file&&file.type==='image/gif'){const reader=new FileReader();reader.onload=function(e){const img=document.createElement('img');img.src=e.target.result;document.body.appendChild(img);const gif=new SuperGif({gif:img});gif.load(function(){const zip=new JSZip();const frameCount=gif.get_length();console.log(`Number of frames detected: ${frameCount}`);document.getElementById('pngOutput').innerHTML='';let loadedFrames=0;function processNextFrame(index){if(index>=frameCount){document.getElementById('downloadZip').disabled=!1;document.getElementById('downloadZip').style="";return}
gif.move_to(index);const canvas=gif.get_canvas();if(canvas){canvas.toBlob(function(blob){const fileName=`frame-${index + 1}.png`;zip.file(fileName,blob);const imgElement=document.createElement('img');imgElement.src=URL.createObjectURL(blob);imgElement.style="width: 100px;";document.getElementById('pngOutput').appendChild(imgElement);loadedFrames++;console.log(`Frame ${index + 1} processed.`);processNextFrame(index+1)},'image/png')}else{console.log(`Canvas for frame ${index + 1} is null.`);processNextFrame(index+1)}}
processNextFrame(0);document.getElementById("load").style="display: none";document.getElementById('downloadZip').addEventListener('click',function(){zip.generateAsync({type:'blob'}).then(function(content){saveAs(content,'frames.zip')})})})};reader.readAsDataURL(file)}}